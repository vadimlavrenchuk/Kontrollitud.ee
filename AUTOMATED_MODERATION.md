# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞—è–≤–æ–∫

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–∞—è–≤–∫–∏ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞ –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É:

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
3. **Basic –ø–ª–∞–Ω** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–¥–æ–±—Ä–µ–Ω–∏–µ (–µ—Å–ª–∏ –ø—Ä–æ—à–µ–ª –ø—Ä–æ–≤–µ—Ä–∫—É)
4. **Pro/Enterprise –ø–ª–∞–Ω—ã** ‚Üí —Å—Ç–∞—Ç—É—Å `pending_payment` ‚Üí –∞–≤—Ç–æ–æ–¥–æ–±—Ä–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
5. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω—É** –æ –≤—Å–µ—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏—è—Ö

---

## üìù –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

#### 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ö–ê–ü–°–ê
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞–∑–≤–∞–Ω–∏–µ "–õ–£–ß–®–ê–Ø –ö–û–ú–ü–ê–ù–ò–Ø!!!"  
**–†–µ—à–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ "–õ—É—á—à–∞—è –ö–æ–º–ø–∞–Ω–∏—è!!!"

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å–ª–∏ –±–æ–ª–µ–µ 80% –±—É–∫–≤ –≤ –í–ï–†–•–ù–ï–ú –†–ï–ì–ò–°–¢–†–ï
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç Title Case (–ø–µ—Ä–≤–∞—è –±—É–∫–≤–∞ –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Å—Ç–æ–Ω—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã (√Ñ, √ñ, √ú, √ï)
- –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: `üìù Normalized name from "–õ–£–ß–®–ê–Ø –ö–û–ú–ü–ê–ù–ò–Ø" to "–õ—É—á—à–∞—è –ö–æ–º–ø–∞–Ω–∏—è"`

```javascript
// –ü—Ä–∏–º–µ—Ä:
"–ö–û–ù–¢–û–†–ê" ‚Üí "–ö–æ–Ω—Ç–æ—Ä–∞"
"BEST COMPANY" ‚Üí "Best Company"
"PARIM ETTEV√ïTE" ‚Üí "Parim Ettev√µte"
```

#### 2. –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω–æ–π –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–∞–∑–≤–∞–Ω–∏–µ "–°—É–ø–µ—Ä –∫–æ–º–ø–∞–Ω–∏—è!!!!!!!!!!"  
**–†–µ—à–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∫—Ä–∞—â–∞–µ—Ç—Å—è –¥–æ "–°—É–ø–µ—Ä –∫–æ–º–ø–∞–Ω–∏—è!!!"

- –ú–∞–∫—Å–∏–º—É–º 3 –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–∞ –ø–æ–¥—Ä—è–¥: `!!!!` ‚Üí `!!!`
- –ú–∞–∫—Å–∏–º—É–º 3 –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–∞ –ø–æ–¥—Ä—è–¥: `????` ‚Üí `???`
- –ú–∞–∫—Å–∏–º—É–º 3 —Ç–æ—á–∫–∏ –ø–æ–¥—Ä—è–¥ (–º–Ω–æ–≥–æ—Ç–æ—á–∏–µ): `....` ‚Üí `...`
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –Ω–∞–∑–≤–∞–Ω–∏—é, –æ–ø–∏—Å–∞–Ω–∏—é –∏ –¥—Ä—É–≥–∏–º —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª—è–º
- –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: `‚úÇÔ∏è Removed excessive punctuation from: "..."`

```javascript
// –ü—Ä–∏–º–µ—Ä—ã:
"–õ—É—á—à–∞—è —Ñ–∏—Ä–º–∞!!!!!" ‚Üí "–õ—É—á—à–∞—è —Ñ–∏—Ä–º–∞!!!"
"–ö–æ–≥–¥–∞????" ‚Üí "–ö–æ–≥–¥–∞???"
"–ú–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞....." ‚Üí "–ú–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞..."
```

#### 3. –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –º–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞ —ç—Å—Ç–æ–Ω—Å–∫–æ–º (et), –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (en), —Ä—É—Å—Å–∫–æ–º (ru)
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω–æ–π –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –∫–æ –≤—Å–µ–º —è–∑—ã–∫–∞–º
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±—ä–µ–∫—Ç–∞ –æ–ø–∏—Å–∞–Ω–∏—è

---

## üö´ –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ (Blacklist)

### –¢–µ–∫—É—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤:

#### 1. –ú–∞—Ç (Estonian)
- pask, sitt, kurat, vittu, persse, loll, idioot, t√ºra

#### 2. –ú–∞—Ç (Russian - —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω –≤ –≠—Å—Ç–æ–Ω–∏–∏)
- –±–ª—è—Ç—å, —Å—É–∫–∞, —Ö—É–π, –ø–∏–∑–¥–∞, –µ–±–∞—Ç—å, –º—É–¥–∞–∫, –¥–µ—Ä—å–º–æ

#### 3. –ú–∞—Ç (English)
- fuck, shit, bitch, asshole, damn, bastard, crap

#### 4. Scam/–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ
- scam, fraud, fake, steal, cheat, ponzi, pyramid
- fast money, quick cash, get rich, easy money, free money
- casino online, gambling, bitcoin hack, crypto scam

#### 5. Spam-–ø–∞—Ç—Ç–µ—Ä–Ω—ã
- !!!!!! (6+ –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤)
- AAAAAAA (6+ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥)
- $$$$$$, ###
- CLICK HERE, BUY NOW, LIMITED TIME
- 100% FREE, GUARANTEED, NO RISK

#### 6. –ù–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- porn, sex, xxx, adult, escort, drugs, weapon

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

- **–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã**: `/(.)\1{5,}/g` - –±–æ–ª–µ–µ 6 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥
- **CAPS LOCK —Å–ø–∞–º**: –ë–æ–ª–µ–µ 70% –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤ –≤ —Ç–µ–∫—Å—Ç–µ –¥–ª–∏–Ω–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤
- **–ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ–ª—è**: `name` (–Ω–∞–∑–≤–∞–Ω–∏–µ) –∏ `description` (–æ–ø–∏—Å–∞–Ω–∏–µ)

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞:

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –º–∞—Å—Å–∏–≤ `blackListWords` –≤ `backend/server.js`:

```javascript
const blackListWords = [
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–ª–æ–≤–∞
    '–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç1', 
    '–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç2',
    '–≤–∞—à–µ_–∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–µ_—Å–ª–æ–≤–æ'
];
```

---

## ‚úÖ –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ-–æ–¥–æ–±—Ä–µ–Ω–∏—è

### Basic –ø–ª–∞–Ω (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π):
```
–ü–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏ ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ ‚Üí ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ APPROVED
                                       ‚Üì
                         –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É –≤ Telegram/Email
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–æ–º–ø–∞–Ω–∏—è —Å—Ä–∞–∑—É –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –Ω–∞ —Å–∞–π—Ç–µ

### Pro –ø–ª–∞–Ω (‚Ç¨29/–º–µ—Å):
```
–ü–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏ ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ ‚Üí ‚è≥ –°—Ç–∞—Ç—É—Å PENDING_PAYMENT
                                       ‚Üì
                            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –æ–ø–ª–∞—Ç–µ
                                       ‚Üì
                            Webhook –æ—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
                                       ‚Üì
                            ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ APPROVED + isVerified: true
                                       ‚Üì
                            –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–æ–º–ø–∞–Ω–∏—è –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã

### Enterprise –ø–ª–∞–Ω (‚Ç¨50/–º–µ—Å):
```
–¢–∞ –∂–µ –ª–æ–≥–∏–∫–∞, —á—Ç–æ –∏ Pro, –Ω–æ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- –ó–æ–ª–æ—Ç–∞—è —Ä–∞–º–∫–∞ –∏ –∞–Ω–∏–º–∞—Ü–∏—è
- –ó–Ω–∞—á–æ–∫ TOP Priority
- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –±–ª–æ–≥–∞
```

---

## üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∞–¥–º–∏–Ω—É

### –í–∞—Ä–∏–∞–Ω—Ç 1: Telegram Bot (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∏–º—è –∏ username –¥–ª—è –±–æ—Ç–∞
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

#### –®–∞–≥ 2: –ü–æ–ª—É—á–∏—Ç–µ Chat ID
1. –û—Ç–∫—Ä–æ–π—Ç–µ [@userinfobot](https://t.me/userinfobot)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à Chat ID (–Ω–∞–ø—Ä–∏–º–µ—Ä: `987654321`)

#### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
```bash
cd backend
npm install axios
```

#### –®–∞–≥ 4: –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`
```env
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=987654321
```

#### –®–∞–≥ 5: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥ –≤ `server.js`
```javascript
// –í —Ñ—É–Ω–∫—Ü–∏–∏ sendAdminNotification():
const axios = require('axios'); // –î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞

async function sendAdminNotification(companyName, action, subscriptionLevel) {
    const message = `
üîî –ù–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ${action === 'approved' ? '–æ–¥–æ–±—Ä–µ–Ω–∞' : '–æ—Ç–∫–ª–æ–Ω–µ–Ω–∞'}

üìä –ù–∞–∑–≤–∞–Ω–∏–µ: ${companyName}
üí∞ –ü–ª–∞–Ω: ${subscriptionLevel}
‚è∞ –í—Ä–µ–º—è: ${new Date().toLocaleString('et-EE', { timeZone: 'Europe/Tallinn' })}
    `.trim();
    
    const TELEGRAM_BOT_TOKEN = process.env.TELEGRAM_BOT_TOKEN;
    const TELEGRAM_CHAT_ID = process.env.TELEGRAM_CHAT_ID;
    
    if (TELEGRAM_BOT_TOKEN && TELEGRAM_CHAT_ID) {
        try {
            await axios.post(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                chat_id: TELEGRAM_CHAT_ID,
                text: message
            });
            console.log('‚úÖ Telegram notification sent');
        } catch (error) {
            console.error('‚ùå Telegram notification failed:', error.message);
        }
    }
}
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Email (—á–µ—Ä–µ–∑ Nodemailer)

#### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nodemailer
```bash
cd backend
npm install nodemailer
```

#### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`
```env
ADMIN_EMAIL=your-email@gmail.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
```

> **–í–∞–∂–Ω–æ –¥–ª—è Gmail**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [App Password](https://support.google.com/accounts/answer/185833), –∞ –Ω–µ –æ–±—ã—á–Ω—ã–π –ø–∞—Ä–æ–ª—å

#### –®–∞–≥ 3: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥ –≤ `server.js`
```javascript
const nodemailer = require('nodemailer'); // –î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞

async function sendAdminNotification(companyName, action, subscriptionLevel) {
    const message = `
üîî –ù–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ${action === 'approved' ? '–æ–¥–æ–±—Ä–µ–Ω–∞' : '–æ—Ç–∫–ª–æ–Ω–µ–Ω–∞'}

üìä –ù–∞–∑–≤–∞–Ω–∏–µ: ${companyName}
üí∞ –ü–ª–∞–Ω: ${subscriptionLevel}
‚è∞ –í—Ä–µ–º—è: ${new Date().toLocaleString('et-EE', { timeZone: 'Europe/Tallinn' })}
    `.trim();
    
    if (process.env.ADMIN_EMAIL) {
        try {
            const transporter = nodemailer.createTransport({
                host: process.env.SMTP_HOST,
                port: process.env.SMTP_PORT,
                secure: false,
                auth: {
                    user: process.env.SMTP_USER,
                    pass: process.env.SMTP_PASS
                }
            });
            
            await transporter.sendMail({
                from: `"Kontrollitud.ee" <${process.env.SMTP_USER}>`,
                to: process.env.ADMIN_EMAIL,
                subject: `–ù–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ${action === 'approved' ? '–æ–¥–æ–±—Ä–µ–Ω–∞' : '–æ—Ç–∫–ª–æ–Ω–µ–Ω–∞'}`,
                text: message
            });
            
            console.log('‚úÖ Email notification sent');
        } catch (error) {
            console.error('‚ùå Email notification failed:', error.message);
        }
    }
}
```

---

## üí≥ Webhook –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π

### Endpoint: `POST /api/webhooks/payment`

–≠—Ç–æ—Ç endpoint –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –≤–∞—à–µ–π –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ (Stripe, PayPal, –∏ —Ç.–¥.)

#### –î–ª—è Stripe:

1. **–°–æ–∑–¥–∞–π—Ç–µ Webhook** –≤ [Stripe Dashboard](https://dashboard.stripe.com/webhooks)
2. **URL**: `https://your-domain.com/api/webhooks/payment`
3. **–°–æ–±—ã—Ç–∏—è**: 
   - `payment_intent.succeeded`
   - `checkout.session.completed`

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –∫–æ–¥–µ** (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ `server.js`):

```javascript
const stripe = require('stripe')(process.env.STRIPE_SECRET_KEY);

app.post('/api/webhooks/payment', express.raw({ type: 'application/json' }), async (req, res) => {
    const sig = req.headers['stripe-signature'];
    const webhookSecret = process.env.STRIPE_WEBHOOK_SECRET;
    
    let event;
    try {
        event = stripe.webhooks.constructEvent(req.body, sig, webhookSecret);
    } catch (err) {
        return res.status(400).send(`Webhook Error: ${err.message}`);
    }
    
    if (event.type === 'payment_intent.succeeded' || event.type === 'checkout.session.completed') {
        const session = event.data.object;
        
        // –ò–∑–≤–ª–µ–∫–∏—Ç–µ companyId –∏–∑ metadata
        const companyId = session.metadata.companyId;
        
        // –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–º–ø–∞–Ω–∏—é
        const company = await Company.findById(companyId);
        if (company && company.approvalStatus === 'pending_payment') {
            company.approvalStatus = 'approved';
            company.isVerified = true;
            company.paymentConfirmedAt = new Date();
            await company.save();
            
            await sendAdminNotification(company.name, 'approved', company.subscriptionLevel);
        }
    }
    
    res.json({ received: true });
});
```

#### –î–ª—è PayPal:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ IPN/Webhooks** –≤ [PayPal Dashboard](https://developer.paypal.com/)
2. **URL**: `https://your-domain.com/api/webhooks/payment`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–ø–∏—Å—å** —Å–æ–≥–ª–∞—Å–Ω–æ [PayPal –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://developer.paypal.com/docs/api-basics/notifications/webhooks/)

---

## üìä –ù–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã –∫–æ–º–ø–∞–Ω–∏–π

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è |
|--------|----------|----------------------|
| `pending` | –û–∂–∏–¥–∞–µ—Ç —Ä—É—á–Ω–æ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏ | –°—Ç–∞—Ä—ã–π —Ä–µ–∂–∏–º (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è auto) |
| `approved` | –û–¥–æ–±—Ä–µ–Ω–æ, –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ | Basic: —Å—Ä–∞–∑—É; Pro/Enterprise: –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã |
| `rejected` | –û—Ç–∫–ª–æ–Ω–µ–Ω–æ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Å —á–µ—Ä–Ω—ã–º —Å–ø–∏—Å–∫–æ–º |
| `pending_payment` | –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã | Pro/Enterprise –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –ö–ê–ü–°–ê (–∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
```bash
curl -X POST http://localhost:5000/api/companies \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–õ–£–ß–®–ê–Ø –ö–û–ú–ü–ê–ù–ò–Ø",
    "description": "–û—Ç–ª–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å",
    "subscriptionLevel": "basic",
    "email": "test@test.com",
    "phone": "+3725551234",
    "city": "Tallinn"
  }'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: 
- –ù–∞–∑–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ "–õ—É—á—à–∞—è –ö–æ–º–ø–∞–Ω–∏—è"
- `approvalStatus: "approved"`
- –õ–æ–≥: `üìù Normalized name from "–õ–£–ß–®–ê–Ø –ö–û–ú–ü–ê–ù–ò–Ø" to "–õ—É—á—à–∞—è –ö–æ–º–ø–∞–Ω–∏—è"`

### –¢–µ—Å—Ç 2: –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω–æ–π –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏
```bash
curl -X POST http://localhost:5000/api/companies \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–°—É–ø–µ—Ä –∫–æ–º–ø–∞–Ω–∏—è!!!!!",
    "description": "–õ—É—á—à–∏–π —Å–µ—Ä–≤–∏—Å –≤ –≥–æ—Ä–æ–¥–µ?????",
    "subscriptionLevel": "basic",
    "email": "test@test.com",
    "phone": "+3725551234",
    "city": "Tallinn"
  }'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: 
- –ù–∞–∑–≤–∞–Ω–∏–µ: "–°—É–ø–µ—Ä –∫–æ–º–ø–∞–Ω–∏—è!!!"
- –û–ø–∏—Å–∞–Ω–∏–µ: "–õ—É—á—à–∏–π —Å–µ—Ä–≤–∏—Å –≤ –≥–æ—Ä–æ–¥–µ???"
- `approvalStatus: "approved"`
- –õ–æ–≥: `‚úÇÔ∏è Removed excessive punctuation from: ...`

### –¢–µ—Å—Ç 3: Basic –ø–ª–∞–Ω (–∞–≤—Ç–æ–æ–¥–æ–±—Ä–µ–Ω–∏–µ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π)
```bash
curl -X POST http://localhost:5000/api/companies \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Test Company",
    "description": "Normal description",
    "subscriptionLevel": "basic",
    "email": "test@test.com",
    "phone": "+3725551234",
    "city": "Tallinn"
  }'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: `approvalStatus: "approved"`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É

### –¢–µ—Å—Ç 4: –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)
```bash
curl -X POST http://localhost:5000/api/companies \
  -H "Content-Type: application/json" \
  -d '{
    "name": "SCAM COMPANY!!!!!!",
    "description": "FAST MONEY GUARANTEED",
    "subscriptionLevel": "basic",
    "email": "test@test.com",
    "phone": "+3725551234",
    "city": "Tallinn"
  }'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: `approvalStatus: "rejected"`, –æ—à–∏–±–∫–∞ 400

### –¢–µ—Å—Ç 5: Pro –ø–ª–∞–Ω (–æ–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã)
```bash
curl -X POST http://localhost:5000/api/companies \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Pro Company",
    "description": "Premium business",
    "subscriptionLevel": "pro",
    "email": "test@test.com",
    "phone": "+3725551234",
    "city": "Tallinn"
  }'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: `approvalStatus: "pending_payment"`

### –¢–µ—Å—Ç 4: Webhook –æ–ø–ª–∞—Ç—ã
```bash
curl -X POST http://localhost:5000/api/webhooks/payment \
  -H "Content-Type: application/json" \
  -d '{
    "companyId": "YOUR_COMPANY_ID_HERE",
    "status": "succeeded",
    "amount": 2900,
    "subscriptionLevel": "pro"
  }'
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è**: –ö–æ–º–ø–∞–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ `approved`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## ÔøΩ‚Äçüíº –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–û–±–Ω–æ–≤–ª–µ–Ω–∏—è)

### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–æ–∫:

#### –î–ª—è –∑–∞—è–≤–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending` –∏–ª–∏ `pending_payment`:
- ‚úÖ **Approve** - –æ–¥–æ–±—Ä–∏—Ç—å —Å —Ç–µ–∫—É—â–∏–º –ø–ª–∞–Ω–æ–º
- üìÑ **Downgrade to Basic** - –ø–æ–Ω–∏–∑–∏—Ç—å –¥–æ Basic (–µ—Å–ª–∏ –Ω–µ Basic)
- ‚ö° **Change to Pro** - –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ Pro (–µ—Å–ª–∏ –Ω–µ Pro)
- üíé **Upgrade to Enterprise** - –ø–æ–≤—ã—Å–∏—Ç—å –¥–æ Enterprise (–µ—Å–ª–∏ –Ω–µ Enterprise)
- üö´ **Reject** - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É

#### –î–ª—è –∑–∞—è–≤–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `approved`:
- ‚úÖ **Already Approved** - –±–µ–π–¥–∂ (–Ω–µ –∫–Ω–æ–ø–∫–∞)
- üö´ **Ban/Block** - –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å/–∑–∞–±–∞–Ω–∏—Ç—å –∫–æ–º–ø–∞–Ω–∏—é

### –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:
```jsx
{request.approvalStatus !== 'approved' && (
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –æ–¥–æ–±—Ä–µ–Ω–∏—è
)}

{request.approvalStatus === 'approved' && (
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂ "Already Approved"
)}

// –ö–Ω–æ–ø–∫–∞ Ban/Block –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
```

### –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- –ó–µ–ª–µ–Ω—ã–π –±–µ–π–¥–∂ "Already Approved" –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö
- –ö–Ω–æ–ø–∫–∞ "Reject" –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "Ban/Block" –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö
- –°–∫—Ä—ã–≤–∞—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞ –¥–ª—è —É–∂–µ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∏ –ø–ª–∞–Ω–æ–≤, –æ—Ç–ª–∏—á–Ω—ã—Ö –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ

---

## ÔøΩüîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```env
# Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here

# Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
ADMIN_EMAIL=admin@kontrollitud.ee
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (Stripe –ø—Ä–∏–º–µ—Ä)
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# –ò–ª–∏ PayPal
PAYPAL_CLIENT_ID=your_paypal_client_id
PAYPAL_SECRET=your_paypal_secret
```

---

## üìù –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `üìù Normalized name from "–ù–ê–ó–í–ê–ù–ò–ï" to "–ù–∞–∑–≤–∞–Ω–∏–µ"` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –ö–ê–ü–°
- `‚úÇÔ∏è Removed excessive punctuation from: ...` - —É–¥–∞–ª–µ–Ω–∞ –∏–∑–±—ã—Ç–æ—á–Ω–∞—è –ø—É–Ω–∫—Ç—É–∞—Ü–∏—è

**–ú–æ–¥–µ—Ä–∞—Ü–∏—è:**
- `üö´ Blacklisted word detected: ...` - –Ω–∞–π–¥–µ–Ω–æ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–µ —Å–ª–æ–≤–æ
- `üö´ Spam pattern detected (excessive repetition) in: ...` - –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Å–ø–∞–º-–ø–∞—Ç—Ç–µ—Ä–Ω
- `üö´ Excessive caps detected in: ...` - –∏–∑–±—ã—Ç–æ–∫ –∑–∞–≥–ª–∞–≤–Ω—ã—Ö –±—É–∫–≤ (–≤ –æ–ø–∏—Å–∞–Ω–∏–∏)

**–ê–≤—Ç–æ-–æ–¥–æ–±—Ä–µ–Ω–∏–µ:**
- `‚úÖ Basic company auto-approved: ...` - Basic –ø–ª–∞–Ω –æ–¥–æ–±—Ä–µ–Ω
- `üí∞ pro company pending payment: ...` - Pro/Enterprise –æ–∂–∏–¥–∞—é—Ç –æ–ø–ª–∞—Ç—ã
- `‚úÖ Company auto-approved after payment: ...` - –û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- `üìß Admin notification: ...` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ

–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ Docker:
```bash
docker logs kontrollitudee-backend-1 -f
```

---

## üöÄ –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
docker-compose down
docker-compose up --build
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–ª–æ–≤ –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –∞–≤—Ç–æ–æ–¥–æ–±—Ä–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ:
- `backend/server.js` ‚Üí –º–∞—Å—Å–∏–≤ `blackListWords`
- `backend/server.js` ‚Üí —Ñ—É–Ω–∫—Ü–∏—è `containsBlacklistedWords()`
- `backend/server.js` ‚Üí —Ñ—É–Ω–∫—Ü–∏—è `sendAdminNotification()`

---

## 6. Subscription Expiration Management

### 6.1 Automatic Subscription Checks

**Cron Job Schedule:**
- **Daily Check:** 3:00 AM Europe/Tallinn timezone
- **For Testing:** Set to `*/5 * * * *` (every 5 minutes) or `0 * * * *` (every hour)

**What Happens Daily:**
1. **3-Day Reminders:** Find companies with `planExpiresAt` in 3 days ‚Üí send warning email
2. **Downgrade Expired:** Find expired pro/enterprise plans ‚Üí reset to basic, clear paid features

### 6.2 Email Configuration (SMTP)

Add to **backend/.env**:

```env
# SMTP Configuration (Gmail Example)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# For Gmail: Enable 2FA ‚Üí Generate App Password
# https://myaccount.google.com/apppasswords

# Optional: Run subscription check on server startup (for testing)
RUN_SUBSCRIPTION_CHECK_ON_STARTUP=true
```

**Other SMTP Providers:**
- **SendGrid:** `smtp.sendgrid.net:587` (recommended for production)
- **Mailgun:** `smtp.mailgun.org:587`
- **Outlook:** `smtp-mail.outlook.com:587`

### 6.3 Subscription Fields in Schema

```javascript
planExpiresAt: Date          // Expiration date for pro/enterprise plans
planReminderSent: Boolean    // Flag: was 3-day reminder sent?
planDowngradedAt: Date       // When was plan auto-downgraded to basic?
```

### 6.4 Email Templates

**3-Day Reminder Email:**
```
Subject: ‚ö†Ô∏è Your subscription expires in 3 days

Your "Pro/Enterprise" subscription expires on [date].
To renew, contact: info@kontrollitud.ee
```

**Expiration Notice Email:**
```
Subject: ‚ùå Your subscription has expired

Your plan has been downgraded to Basic.
Features removed: Photo, Social Links, Blog Article.
To restore, renew your subscription.
```

### 6.5 Testing Subscription Checks

**1. Create Test Company with Expired Plan:**

```bash
curl -X POST http://localhost:5000/api/companies \
-H "Content-Type: application/json" \
-d '{
  "name": "Test Pro Company",
  "email": "test@example.com",
  "subscriptionLevel": "pro",
  "planExpiresAt": "2024-01-01",
  "image": "https://example.com/photo.jpg",
  "instagramUrl": "https://instagram.com/test",
  "approvalStatus": "approved"
}'
```

**2. Manually Trigger Check (in Node console or temporary endpoint):**

```javascript
await checkSubscriptions();
```

**3. Verify Results:**
- Check MongoDB: `subscriptionLevel` changed to `"basic"`
- Paid fields cleared: `image`, `instagramUrl`, `tiktokUrl`, `youtubeUrl`, `blogArticleUrl` set to `null`
- Email sent to `userEmail`

**4. Check Logs:**

```
‚è∞ Cron job triggered: Daily subscription check
üìß Sending expiration reminders...
   Found 2 companies expiring in 3 days
   ‚úÖ Reminder sent to test@example.com
‚¨áÔ∏è Downgrading expired subscriptions...
   Found 1 expired subscriptions
   ‚úÖ Downgraded "Test Pro Company" from pro to basic
```

### 6.6 Production Deployment

**1. Update Docker Compose:**

Add SMTP variables to `docker-compose.yml`:

```yaml
backend:
  environment:
    - SMTP_HOST=smtp.gmail.com
    - SMTP_PORT=587
    - SMTP_USER=${SMTP_USER}
    - SMTP_PASS=${SMTP_PASS}
```

**2. Set Variables on Server:**

```bash
export SMTP_USER="your-email@gmail.com"
export SMTP_PASS="your-app-password"
```

**3. Rebuild Containers:**

```bash
docker-compose down
docker-compose up --build -d
```

**4. Verify Cron Job:**

```bash
docker logs backend-container | grep "Cron job scheduled"
```

### 6.7 Manual Subscription Renewal

**Admin can manually extend subscription via API:**

```bash
curl -X PATCH http://localhost:5000/api/companies/:id/extend-subscription \
-H "Content-Type: application/json" \
-d '{
  "months": 1,
  "plan": "pro"
}'
```

**Implementation (add to server.js):**

```javascript
app.patch('/api/companies/:id/extend-subscription', async (req, res) => {
    const { months, plan } = req.body;
    const company = await Company.findById(req.params.id);
    
    const currentExpiry = company.planExpiresAt || new Date();
    const newExpiry = new Date(currentExpiry);
    newExpiry.setMonth(newExpiry.getMonth() + months);
    
    company.subscriptionLevel = plan;
    company.planExpiresAt = newExpiry;
    company.planReminderSent = false;
    await company.save();
    
    res.json({ message: 'Subscription extended', newExpiry });
});
```

